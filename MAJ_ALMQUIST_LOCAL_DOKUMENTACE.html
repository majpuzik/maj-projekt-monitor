<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAJ-ALMQUIST-LOCAL - Projektov√° Dokumentace</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header .subtitle {
            font-size: 1.3em;
            opacity: 0.95;
        }

        .version-badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 20px;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .nav {
            background: #f0fdf4;
            padding: 20px 40px;
            border-bottom: 3px solid #10b981;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav ul {
            list-style: none;
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
        }

        .nav a {
            color: #059669;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .nav a:hover {
            color: #10b981;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 60px;
        }

        .section h2 {
            color: #059669;
            font-size: 2.2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #10b981;
        }

        .section h3 {
            color: #047857;
            font-size: 1.6em;
            margin: 30px 0 15px 0;
        }

        .diagram-container {
            background: #f0fdf4;
            padding: 30px;
            border-radius: 10px;
            margin: 30px 0;
            border: 2px solid #d1fae5;
        }

        .diagram-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #059669;
            margin-bottom: 20px;
            text-align: center;
        }

        .mermaid {
            text-align: center;
        }

        .info-box {
            background: #dbeafe;
            border-left: 5px solid #3b82f6;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 5px solid #f59e0b;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d1fae5;
            border-left: 5px solid #10b981;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        table th {
            background: #059669;
            color: white;
            padding: 15px;
            text-align: left;
        }

        table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e5e7eb;
        }

        table tr:hover {
            background: #f0fdf4;
        }

        .component-card {
            background: white;
            border: 2px solid #d1fae5;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .component-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
        }

        .component-card h4 {
            color: #059669;
            font-size: 1.4em;
            margin-bottom: 10px;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
            margin-right: 8px;
        }

        .badge-crawler { background: #fce7f3; color: #831843; }
        .badge-rag { background: #dbeafe; color: #1e40af; }
        .badge-legal { background: #fef3c7; color: #92400e; }
        .badge-grants { background: #e0e7ff; color: #3730a3; }
        .badge-tenders { background: #ffedd5; color: #9a3412; }
        .badge-ai { background: #d1fae5; color: #065f46; }

        code {
            background: #f3f4f6;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #059669;
        }

        pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card .number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-card .label {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            border-bottom: 2px dotted #10b981;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #1f2937;
            color: #fff;
            text-align: left;
            border-radius: 8px;
            padding: 15px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        footer {
            background: #1f2937;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 60px;
        }

        @media print {
            .nav { display: none; }
            body { background: white; }
            .container { box-shadow: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>‚öñÔ∏è MAJ-ALMQUIST-LOCAL</h1>
            <p class="subtitle">Complete Legal, Grants & Tenders RAG System</p>
            <p class="subtitle">AI-Powered Analysis & Autonomous Crawling</p>
            <div class="version-badge">Production | 978MB | 151 Python Modules</div>
        </div>

        <!-- Navigation -->
        <div class="nav">
            <ul>
                <li><a href="#prehled">P≈ôehled</a></li>
                <li><a href="#architektura">Architektura</a></li>
                <li><a href="#komponenty">Komponenty</a></li>
                <li><a href="#databaze">Datab√°ze & Storage</a></li>
                <li><a href="#dataflow">Data Flow</a></li>
                <li><a href="#crawlers">Crawlers</a></li>
                <li><a href="#rag">RAG System</a></li>
                <li><a href="#deployment">Deployment</a></li>
            </ul>
        </div>

        <!-- Content -->
        <div class="content">

            <!-- Section: P≈ôehled -->
            <div class="section" id="prehled">
                <h2>üìã P≈ôehled Projektu</h2>

                <div class="success-box">
                    <strong>MAJ-ALMQUIST-LOCAL</strong> je komplexn√≠ pr√°vn√≠ a ekonomick√Ω informaƒçn√≠ syst√©m
                    vyu≈æ√≠vaj√≠c√≠ RAG (Retrieval-Augmented Generation) pro zpracov√°n√≠ pr√°vn√≠ch rozhodnut√≠,
                    dotac√≠, ve≈ôejn√Ωch zak√°zek a ekonomick√Ωch zpr√°v. Syst√©m automaticky crawluje,
                    indexuje a poskytuje AI-powered anal√Ωzy.
                </div>

                <div class="grid">
                    <div class="stat-card">
                        <div class="number">151</div>
                        <div class="label">Python Modul≈Ø</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">12</div>
                        <div class="label">Shell Script≈Ø</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">978MB</div>
                        <div class="label">Velikost Projektu</div>
                    </div>
                    <div class="stat-card">
                        <div class="number">18MB</div>
                        <div class="label">Central Database</div>
                    </div>
                </div>

                <h3>Hlavn√≠ Zdroje Dat</h3>
                <table>
                    <tr>
                        <th>Zdroj</th>
                        <th>Typ</th>
                        <th>Update Frekvence</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>üèõÔ∏è NSS (Nejvy≈°≈°√≠ spr√°vn√≠ soud)</td>
                        <td>Legal Decisions</td>
                        <td>Dennƒõ</td>
                        <td>‚úì Active</td>
                    </tr>
                    <tr>
                        <td>‚öñÔ∏è √östavn√≠ soud</td>
                        <td>Constitutional Court</td>
                        <td>Dennƒõ</td>
                        <td>‚úì Active</td>
                    </tr>
                    <tr>
                        <td>üìú Sb√≠rka z√°kon≈Ø</td>
                        <td>Laws & Regulations</td>
                        <td>T√Ωdnƒõ</td>
                        <td>‚úì Active</td>
                    </tr>
                    <tr>
                        <td>üí∞ DotaceEU.cz</td>
                        <td>Grants & Funding</td>
                        <td>Dennƒõ</td>
                        <td>‚úì Active</td>
                    </tr>
                    <tr>
                        <td>üìã Vƒõstn√≠k ve≈ôejn√Ωch zak√°zek</td>
                        <td>Public Tenders</td>
                        <td>Dennƒõ</td>
                        <td>‚úì Active</td>
                    </tr>
                    <tr>
                        <td>üì∞ Ekonomick√© zpr√°vy</td>
                        <td>Economic News</td>
                        <td>Ka≈ædou hodinu</td>
                        <td>‚úì Active</td>
                    </tr>
                </table>

                <h3>Kl√≠ƒçov√© Funkce</h3>
                <div class="component-card">
                    <h4>ü§ñ Autonomous Crawling</h4>
                    <span class="badge badge-crawler">CRAWLER</span>
                    <p>Automatick√© crawlov√°n√≠ pr√°vn√≠ch rozhodnut√≠, dotac√≠ a zak√°zek pomoc√≠ Playwright.
                    Inteligentn√≠ detekce zmƒõn, gap detection a prioritizace.</p>
                </div>

                <div class="component-card">
                    <h4>üß† RAG (Retrieval-Augmented Generation)</h4>
                    <span class="badge badge-rag">RAG</span>
                    <span class="badge badge-ai">AI</span>
                    <p>Vektorov√© embeddings (sentence-transformers), Qdrant vector store,
                    semantic search a AI-powered anal√Ωzy s GPT-4/Claude.</p>
                </div>

                <div class="component-card">
                    <h4>üìä Self-Learning System</h4>
                    <span class="badge badge-ai">AI</span>
                    <p>Automatick√© uƒçen√≠ se z dotaz≈Ø u≈æivatel≈Ø, gap detection,
                    relevance scoring a continuous improvement.</p>
                </div>

                <div class="component-card">
                    <h4>üìÑ Paperless Integration</h4>
                    <span class="badge badge-legal">DOCUMENT</span>
                    <p>Integrace s Paperless-ngx pro spr√°vu dokument≈Ø, OCR,
                    automatick√© tagov√°n√≠ a fulltextov√© vyhled√°v√°n√≠.</p>
                </div>
            </div>

            <!-- Section: Architektura -->
            <div class="section" id="architektura">
                <h2>üèóÔ∏è Architektura Syst√©mu</h2>

                <div class="diagram-container">
                    <div class="diagram-title">Celkov√° Architektura</div>
                    <div class="mermaid">
graph TB
    subgraph "Data Sources"
        NSS[NSS.cz<br/>Legal Decisions]
        USOUD[√östavn√≠ soud<br/>Constitutional Court]
        LAWS[Sb√≠rka z√°kon≈Ø<br/>Laws]
        DOTACE[DotaceEU.cz<br/>Grants]
        VESTNIK[Vƒõstn√≠k VZ<br/>Tenders]
        NEWS[Economic News]
    end

    subgraph "Crawling Layer"
        CRAWLER_LEGAL[Legal Crawlers<br/>Playwright]
        CRAWLER_GRANTS[Grants Crawler<br/>API + Selenium]
        CRAWLER_TENDERS[Tenders Crawler<br/>Playwright]
        CRAWLER_NEWS[News Crawler<br/>BeautifulSoup]
    end

    subgraph "Processing Layer"
        DEDUP[Deduplication]
        OCR[OCR & PDF Parse]
        CLEAN[Data Cleaning]
        ENRICH[Data Enrichment]
    end

    subgraph "Storage Layer"
        CDB[(Central Database<br/>SQLite)]
        QDRANT[(Qdrant<br/>Vector Store)]
        PAPERLESS[(Paperless-ngx<br/>Documents)]
    end

    subgraph "AI/RAG Layer"
        EMBED[Embeddings<br/>sentence-transformers]
        SEARCH[Semantic Search]
        LLM[LLM Integration<br/>GPT-4/Claude]
        LEARNING[Self-Learning<br/>Query Logger]
    end

    subgraph "Application Layer"
        API[FastAPI Backend]
        DASHBOARD[Web Dashboard<br/>Flask]
        MONITOR[Central Monitor]
    end

    subgraph "Users"
        LAWYER[Pr√°vn√≠k]
        CORP[Firma]
        GRANT[Grant Seeker]
    end

    NSS --> CRAWLER_LEGAL
    USOUD --> CRAWLER_LEGAL
    LAWS --> CRAWLER_LEGAL
    DOTACE --> CRAWLER_GRANTS
    VESTNIK --> CRAWLER_TENDERS
    NEWS --> CRAWLER_NEWS

    CRAWLER_LEGAL --> DEDUP
    CRAWLER_GRANTS --> DEDUP
    CRAWLER_TENDERS --> DEDUP
    CRAWLER_NEWS --> CLEAN

    DEDUP --> OCR
    OCR --> CLEAN
    CLEAN --> ENRICH

    ENRICH --> CDB
    ENRICH --> PAPERLESS
    ENRICH --> EMBED

    EMBED --> QDRANT
    QDRANT --> SEARCH
    CDB --> API

    SEARCH --> LLM
    API --> LLM
    LLM --> LEARNING

    API --> DASHBOARD
    DASHBOARD --> MONITOR

    DASHBOARD --> LAWYER
    DASHBOARD --> CORP
    DASHBOARD --> GRANT

    style NSS fill:#fce7f3
    style QDRANT fill:#dbeafe
    style LLM fill:#d1fae5
    style DASHBOARD fill:#e0e7ff
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="diagram-title">Component Structure</div>
                    <div class="mermaid">
classDiagram
    class AlmquistCrawler {
        +crawl_source()
        +parse_data()
        +store_to_cdb()
        +gap_detection()
    }

    class RAGSystem {
        +create_embeddings()
        +semantic_search()
        +query_llm()
        +update_index()
    }

    class SelfLearning {
        +log_query()
        +detect_gaps()
        +score_relevance()
        +improve_results()
    }

    class CentralMonitor {
        +monitor_crawlers()
        +check_health()
        +generate_reports()
        +send_alerts()
    }

    AlmquistCrawler --> RAGSystem
    RAGSystem --> SelfLearning
    CentralMonitor --> AlmquistCrawler
    CentralMonitor --> RAGSystem
                    </div>
                </div>
            </div>

            <!-- Section: Komponenty -->
            <div class="section" id="komponenty">
                <h2>‚öôÔ∏è Hlavn√≠ Komponenty</h2>

                <h3>1. Legal Crawlers (Pr√°vn√≠ Crawlery)</h3>

                <div class="component-card">
                    <h4>almquist_legal_nss_crawler.py</h4>
                    <span class="badge badge-legal">LEGAL</span>
                    <span class="badge badge-crawler">CRAWLER</span>
                    <p><strong>√öƒçel:</strong> Crawlov√°n√≠ rozhodnut√≠ Nejvy≈°≈°√≠ho spr√°vn√≠ho soudu</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Playwright browser automation</li>
                        <li>Full-text extraction z HTML/PDF</li>
                        <li>Metadata parsing (ƒç√≠slo jednac√≠, datum, √∫ƒçastn√≠ci)</li>
                        <li>Automatic deduplication</li>
                    </ul>
                    <p style="margin-top: 15px;"><strong>Cron:</strong> <code>almquist_legal_decisions_cron.sh</code> - dennƒõ v 2:00</p>
                </div>

                <div class="component-card">
                    <h4>almquist_legal_usoud_crawler.py</h4>
                    <span class="badge badge-legal">LEGAL</span>
                    <span class="badge badge-crawler">CRAWLER</span>
                    <p><strong>√öƒçel:</strong> Crawlov√°n√≠ n√°lez≈Ø √östavn√≠ho soudu</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Constitutional court decisions</li>
                        <li>Full-text search integration</li>
                        <li>Advanced metadata extraction</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4>almquist_import_constitutional_court.py</h4>
                    <span class="badge badge-legal">LEGAL</span>
                    <p><strong>√öƒçel:</strong> Bulk import historick√Ωch n√°lez≈Ø √öS</p>
                </div>

                <h3>2. Grants & Tenders Crawlers</h3>

                <div class="component-card">
                    <h4>almquist_grants_dotaceeu_crawler.py</h4>
                    <span class="badge badge-grants">GRANTS</span>
                    <span class="badge badge-crawler">CRAWLER</span>
                    <p><strong>√öƒçel:</strong> Crawlov√°n√≠ dotac√≠ z DotaceEU.cz</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Selenium + API hybrid approach</li>
                        <li>Grant metadata extraction</li>
                        <li>Eligibility checking</li>
                        <li>Deadline tracking</li>
                    </ul>
                    <p style="margin-top: 15px;"><strong>Cron:</strong> <code>almquist_grants_dotaceeu_cron.sh</code> - dennƒõ v 3:00</p>
                </div>

                <div class="component-card">
                    <h4>almquist_grants_playwright_crawler.py</h4>
                    <span class="badge badge-grants">GRANTS</span>
                    <span class="badge badge-crawler">CRAWLER</span>
                    <p><strong>√öƒçel:</strong> Modernƒõj≈°√≠ Playwright-based grants crawler</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Faster & more reliable</li>
                        <li>Headless browser automation</li>
                        <li>JavaScript rendering support</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4>almquist_grant_eligibility_checker.py</h4>
                    <span class="badge badge-grants">GRANTS</span>
                    <span class="badge badge-ai">AI</span>
                    <p><strong>√öƒçel:</strong> AI-powered kontrola zp≈Øsobilosti pro dotace</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Company profile matching</li>
                        <li>Requirements analysis</li>
                        <li>Success probability scoring</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4>almquist_tenders_vestnik_crawler.py</h4>
                    <span class="badge badge-tenders">TENDERS</span>
                    <span class="badge badge-crawler">CRAWLER</span>
                    <p><strong>√öƒçel:</strong> Crawlov√°n√≠ ve≈ôejn√Ωch zak√°zek z Vƒõstn√≠ku VZ</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Public tender notifications</li>
                        <li>Contract awards</li>
                        <li>Tender specifications</li>
                    </ul>
                    <p style="margin-top: 15px;"><strong>Cron:</strong> <code>almquist_tenders_vestnik_cron.sh</code> - dennƒõ v 4:00</p>
                </div>

                <h3>3. RAG System</h3>

                <div class="component-card">
                    <h4>almquist_rag_search.py</h4>
                    <span class="badge badge-rag">RAG</span>
                    <span class="badge badge-ai">AI</span>
                    <p><strong>√öƒçel:</strong> Semantic search p≈ôes vektorov√© embeddings</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>sentence-transformers embeddings</li>
                        <li>Qdrant vector similarity search</li>
                        <li>Hybrid search (vector + keyword)</li>
                        <li>Result ranking & filtering</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4>almquist_unified_rag_launcher.py</h4>
                    <span class="badge badge-rag">RAG</span>
                    <p><strong>√öƒçel:</strong> Unified launcher pro v≈°echny RAG funkce</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Single entry point</li>
                        <li>Multi-domain search (legal, grants, tenders)</li>
                        <li>LLM integration (GPT-4, Claude, Gemini)</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4>almquist_self_learning_master.py</h4>
                    <span class="badge badge-ai">AI</span>
                    <p><strong>√öƒçel:</strong> Continuous learning z user queries</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Query logging to CDB</li>
                        <li>Gap detection (missing data)</li>
                        <li>Relevance scoring</li>
                        <li>Feedback loop for crawlers</li>
                    </ul>
                    <p style="margin-top: 15px;"><strong>Cron:</strong> <code>almquist_self_learning_cron.sh</code> - ka≈ædou hodinu</p>
                </div>

                <h3>4. Monitoring & Management</h3>

                <div class="component-card">
                    <h4>almquist_central_monitor_server.py</h4>
                    <span class="badge badge-rag">MONITOR</span>
                    <p><strong>√öƒçel:</strong> Centr√°ln√≠ monitoring v≈°ech Almquist komponent</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Real-time status v≈°ech crawler≈Ø</li>
                        <li>üü¢üü°üî¥ Color-coded health indicators</li>
                        <li>Auto-recovery p≈ôi chyb√°ch</li>
                        <li>WebSocket real-time updates</li>
                        <li>Process management (start/stop/restart)</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4>almquist_crawler_watchdog.py</h4>
                    <span class="badge badge-crawler">WATCHDOG</span>
                    <p><strong>√öƒçel:</strong> Watchdog pro automatick√© restartov√°n√≠ zaseknut√Ωch crawler≈Ø</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Health checks ka≈æd√Ωch 5 minut</li>
                        <li>Automatic restart on failure</li>
                        <li>Alert notifications</li>
                    </ul>
                </div>

                <h3>5. Dashboard & UI</h3>

                <div class="component-card">
                    <h4>almquist_dashboard_web.py</h4>
                    <span class="badge badge-rag">WEB</span>
                    <p><strong>√öƒçel:</strong> Web dashboard pro p≈ô√≠stup k dat≈Øm</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Flask web server</li>
                        <li>Search interface</li>
                        <li>Results visualization</li>
                        <li>Statistics & analytics</li>
                    </ul>
                </div>

                <div class="component-card">
                    <h4>almquist_personalized_dashboard.py</h4>
                    <span class="badge badge-rag">WEB</span>
                    <span class="badge badge-ai">AI</span>
                    <p><strong>√öƒçel:</strong> Personalizovan√Ω dashboard dle u≈æivatelsk√Ωch profil≈Ø</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>User profiles (lawyer, company, grant seeker)</li>
                        <li>Custom recommendations</li>
                        <li>Relevance filtering</li>
                    </ul>
                </div>
            </div>

            <!-- Section: Datab√°ze -->
            <div class="section" id="databaze">
                <h2>üóÑÔ∏è Datab√°ze & Storage</h2>

                <div class="diagram-container">
                    <div class="diagram-title">Storage Architecture</div>
                    <div class="mermaid">
graph LR
    subgraph "Structured Data"
        CDB[(Central DB<br/>almquist.db<br/>18MB)]
        LEGAL_DB[(Legal Sources<br/>almquist_legal_sources.db)]
        SOURCES_DB[(Sources<br/>almquist_sources.db)]
    end

    subgraph "Vector Storage"
        QDRANT[(Qdrant<br/>Vector Store<br/>almqist_qdrant_storage/)]
    end

    subgraph "Document Storage"
        PAPERLESS[(Paperless-ngx<br/>Document Management)]
        FILES[File System<br/>PDFs, HTMLs]
    end

    subgraph "Embeddings"
        EMBED_DIR[almquist_rag_embeddings/<br/>Cached Embeddings]
    end

    subgraph "Backups"
        BACKUP_DIR[almquist_rag_backups/<br/>Incremental Backups]
        NAS5[(NAS5<br/>192.168.10.35<br/>Remote Backup)]
    end

    CDB --> QDRANT
    LEGAL_DB --> CDB
    SOURCES_DB --> CDB
    FILES --> PAPERLESS
    EMBED_DIR --> QDRANT

    CDB --> BACKUP_DIR
    BACKUP_DIR --> NAS5

    style CDB fill:#dbeafe
    style QDRANT fill:#e0e7ff
    style PAPERLESS fill:#fef3c7
    style NAS5 fill:#fce7f3
                    </div>
                </div>

                <h3>Central Database (CDB) - almquist.db</h3>

                <div class="success-box">
                    <strong>Lokace:</strong> /home/puzik/almquist-central-log/almquist.db<br>
                    <strong>Velikost:</strong> 18 MB<br>
                    <strong>Engine:</strong> SQLite 3<br>
                    <strong>Tabulky:</strong> 17 (vƒçetnƒõ MAJ-PROJEKT-MONITOR tabulek)
                </div>

                <table>
                    <tr>
                        <th>Tabulka</th>
                        <th>√öƒçel</th>
                        <th>Rows (approx)</th>
                    </tr>
                    <tr>
                        <td><code>events</code></td>
                        <td>V≈°echny syst√©mov√© ud√°losti</td>
                        <td>~135 almquist events</td>
                    </tr>
                    <tr>
                        <td><code>performance_metrics</code></td>
                        <td>V√Ωkonnostn√≠ metriky crawler≈Ø</td>
                        <td>Continuous</td>
                    </tr>
                    <tr>
                        <td><code>test_runs</code></td>
                        <td>Test execution results</td>
                        <td>Historical</td>
                    </tr>
                    <tr>
                        <td><code>dgx_health_checks</code></td>
                        <td>DGX system health</td>
                        <td>Every 5 min</td>
                    </tr>
                    <tr>
                        <td><code>improvements</code></td>
                        <td>Self-learning improvements</td>
                        <td>Accumulating</td>
                    </tr>
                </table>

                <h3>Qdrant Vector Store</h3>

                <div class="component-card">
                    <h4>almqist_qdrant_storage/</h4>
                    <p><strong>√öƒçel:</strong> High-performance vector similarity search</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Embeddings pro v≈°echny dokumenty</li>
                        <li>Fast semantic search (< 100ms)</li>
                        <li>Collections: legal, grants, tenders, news</li>
                        <li>HNSW index pro rychl√© vyhled√°v√°n√≠</li>
                    </ul>
                </div>

                <h3>Paperless-ngx Integration</h3>

                <div class="component-card">
                    <h4>almquist_paperless/</h4>
                    <span class="badge badge-legal">DOCUMENT</span>
                    <p><strong>√öƒçel:</strong> Document management system</p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Automatic OCR for PDFs</li>
                        <li>Full-text search</li>
                        <li>Automatic tagging</li>
                        <li>Sync: <code>almquist_paperless_sync.py</code></li>
                        <li>Cron: <code>almquist_paperless_sync_cron.sh</code></li>
                    </ul>
                </div>
            </div>

            <!-- Section: Data Flow -->
            <div class="section" id="dataflow">
                <h2>üîÑ Data Flow</h2>

                <div class="diagram-container">
                    <div class="diagram-title">Crawler ‚Üí RAG Pipeline</div>
                    <div class="mermaid">
sequenceDiagram
    participant CRON as Cron Job
    participant CRAWLER as Crawler
    participant CDB as Central DB
    participant DEDUP as Deduplication
    participant EMB as Embeddings
    participant QDRANT as Qdrant
    participant RAG as RAG System

    CRON->>CRAWLER: Trigger (2:00 AM)
    CRAWLER->>CRAWLER: Playwright automation
    CRAWLER->>CRAWLER: Parse HTML/PDF
    CRAWLER->>CDB: Check if exists
    CDB-->>CRAWLER: Not found

    CRAWLER->>DEDUP: Fuzzy matching
    DEDUP-->>CRAWLER: Unique

    CRAWLER->>CDB: INSERT document
    CRAWLER->>EMB: Create embeddings
    EMB->>EMB: sentence-transformers
    EMB-->>CRAWLER: Vector [768]

    CRAWLER->>QDRANT: Store vector + metadata
    QDRANT-->>CRAWLER: ‚úì Indexed

    Note over CRAWLER,QDRANT: Document now searchable

    User->>RAG: Query "dotace pro IT firmy"
    RAG->>EMB: Embed query
    EMB-->>RAG: Query vector
    RAG->>QDRANT: Similarity search
    QDRANT-->>RAG: Top 10 matches
    RAG->>CDB: Get full metadata
    CDB-->>RAG: Complete data
    RAG->>User: Ranked results
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="diagram-title">Self-Learning Loop</div>
                    <div class="mermaid">
graph TD
    START[User Query] --> SEARCH[Semantic Search]
    SEARCH --> RESULTS[Results Returned]
    RESULTS --> LOG[Log Query to CDB]

    LOG --> FEEDBACK{User Feedback?}
    FEEDBACK -->|Positive| SCORE_UP[Increase Relevance Score]
    FEEDBACK -->|Negative| SCORE_DOWN[Decrease Relevance Score]
    FEEDBACK -->|No Results| GAP[Gap Detection]

    SCORE_UP --> LEARN[Update Model]
    SCORE_DOWN --> LEARN
    GAP --> PRIORITY[Priority Crawl Queue]

    PRIORITY --> CRAWLER[Trigger Crawler]
    CRAWLER --> NEW_DATA[New Data Collected]
    NEW_DATA --> SEARCH

    LEARN --> IMPROVE[Improved Results]
    IMPROVE --> START

    style GAP fill:#ef4444,color:#fff
    style IMPROVE fill:#10b981,color:#fff
                    </div>
                </div>

                <h3>Data Flow Patterns</h3>

                <div class="component-card">
                    <h4>1. Scheduled Crawling</h4>
                    <p>
                    <span class="tooltip">Cron Trigger<span class="tooltiptext">
                        Shell scripty v /home/puzik/*cron.sh spou≈°tƒõj√≠ crawlery v noci (2-4 AM)
                    </span></span> ‚Üí
                    <span class="tooltip">Crawler Execution<span class="tooltiptext">
                        Playwright browser automation, navigace, parsing
                    </span></span> ‚Üí
                    <span class="tooltip">Data Validation<span class="tooltiptext">
                        Kontrola form√°tu, required fields, data quality
                    </span></span> ‚Üí
                    <span class="tooltip">Deduplication<span class="tooltiptext">
                        Fuzzy matching p≈ôes existing records v CDB
                    </span></span> ‚Üí
                    <span class="tooltip">Storage<span class="tooltiptext">
                        INSERT do CDB + vector embedding do Qdrant
                    </span></span>
                    </p>
                </div>

                <div class="component-card">
                    <h4>2. Query Processing</h4>
                    <p>
                    <span class="tooltip">User Query<span class="tooltiptext">
                        Natural language query p≈ôes web dashboard nebo API
                    </span></span> ‚Üí
                    <span class="tooltip">Query Embedding<span class="tooltiptext">
                        sentence-transformers p≈ôevod na 768-dim vektor
                    </span></span> ‚Üí
                    <span class="tooltip">Vector Search<span class="tooltiptext">
                        Qdrant similarity search (cosine distance)
                    </span></span> ‚Üí
                    <span class="tooltip">Hybrid Ranking<span class="tooltiptext">
                        Kombinace vector similarity + keyword matching + recency
                    </span></span> ‚Üí
                    <span class="tooltip">LLM Enhancement<span class="tooltiptext">
                        GPT-4/Claude summarization a context-aware odpovƒõƒè
                    </span></span> ‚Üí
                    <span class="tooltip">Result Delivery<span class="tooltiptext">
                        Formatted results s metadata, relevance scores, snippets
                    </span></span>
                    </p>
                </div>

                <div class="component-card">
                    <h4>3. Continuous Learning</h4>
                    <p>
                    <span class="tooltip">Query Logging<span class="tooltiptext">
                        Ka≈æd√Ω query se loguje do CDB s timestamp, user, query text
                    </span></span> ‚Üí
                    <span class="tooltip">Result Tracking<span class="tooltiptext">
                        Click-through tracking - kter√© results user kliknul
                    </span></span> ‚Üí
                    <span class="tooltip">Gap Detection<span class="tooltiptext">
                        Identifikace queries bez good results
                    </span></span> ‚Üí
                    <span class="tooltip">Priority Queue<span class="tooltiptext">
                        Missing topics ‚Üí priority pro dal≈°√≠ crawling
                    </span></span> ‚Üí
                    <span class="tooltip">Model Update<span class="tooltiptext">
                        Retraining embeddings s nov√Ωmi daty
                    </span></span>
                    </p>
                </div>
            </div>

            <!-- Section: Deployment -->
            <div class="section" id="deployment">
                <h2>üöÄ Deployment Status</h2>

                <div class="success-box">
                    <strong>‚úì Production Status:</strong> Active na DGX Workstation (192.168.10.200)<br>
                    <strong>‚úì Environment:</strong> Production<br>
                    <strong>‚úì Customer:</strong> Maj Legal Services<br>
                    <strong>‚úì Uptime:</strong> Continuous (cron-based)
                </div>

                <h3>Running Services</h3>

                <table>
                    <tr>
                        <th>Service</th>
                        <th>Type</th>
                        <th>Schedule</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Legal Decisions Crawler</td>
                        <td>Cron</td>
                        <td>Daily 2:00 AM</td>
                        <td>üü¢ Active</td>
                    </tr>
                    <tr>
                        <td>Grants Crawler</td>
                        <td>Cron</td>
                        <td>Daily 3:00 AM</td>
                        <td>üü¢ Active</td>
                    </tr>
                    <tr>
                        <td>Tenders Crawler</td>
                        <td>Cron</td>
                        <td>Daily 4:00 AM</td>
                        <td>üü¢ Active</td>
                    </tr>
                    <tr>
                        <td>Economic News Crawler</td>
                        <td>Cron</td>
                        <td>Hourly</td>
                        <td>üü¢ Active</td>
                    </tr>
                    <tr>
                        <td>Self-Learning Master</td>
                        <td>Cron</td>
                        <td>Hourly</td>
                        <td>üü¢ Active</td>
                    </tr>
                    <tr>
                        <td>RAG Merge</td>
                        <td>Cron</td>
                        <td>Every 6 hours</td>
                        <td>üü¢ Active</td>
                    </tr>
                    <tr>
                        <td>Paperless Sync</td>
                        <td>Cron</td>
                        <td>Every 30 min</td>
                        <td>üü¢ Active</td>
                    </tr>
                    <tr>
                        <td>Crawler Watchdog</td>
                        <td>Daemon</td>
                        <td>Continuous</td>
                        <td>üü¢ Active</td>
                    </tr>
                </table>

                <h3>Network Configuration</h3>

                <div class="diagram-container">
                    <div class="diagram-title">Deployment Topology</div>
                    <div class="mermaid">
graph LR
    DGX[DGX Workstation<br/>192.168.10.200<br/>Almquist Core]
    NAS5[NAS5<br/>192.168.10.35<br/>Backup Storage]
    MAC[Mac Mini M4<br/>192.168.10.69<br/>Development]

    INTERNET[Internet<br/>Data Sources]

    DGX -->|Backup<br/>rsync| NAS5
    DGX -->|Sync| MAC
    DGX <-->|Crawling| INTERNET

    style DGX fill:#10b981,color:#fff
    style NAS5 fill:#f59e0b
    style INTERNET fill:#3b82f6,color:#fff
                    </div>
                </div>

                <h3>Backup Strategy</h3>

                <div class="component-card">
                    <h4>backup_almquist_to_nas5.sh</h4>
                    <p><strong>Strategie:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Denn√≠ backup CDB datab√°ze ‚Üí NAS5</li>
                        <li>T√Ωdenn√≠ full backup cel√©ho projektu</li>
                        <li>Incremental backups embeddings</li>
                        <li>Git commits pro v≈°echny zmƒõny k√≥du</li>
                    </ul>
                    <pre>Backup Target: /mnt/nas5/backups/almquist/
Latest: almquist_backup_20251203_190531.tar.gz
Size: Varies (CDB ~18MB, Full ~978MB)</pre>
                </div>

                <h3>Monitoring</h3>

                <div class="info-box">
                    <strong>Central Monitor:</strong> <code>almquist_central_monitor_server.py</code><br>
                    <strong>Dashboard URL:</strong> http://192.168.10.200:5051 (if running)<br>
                    <strong>Logs:</strong> ~/logs/almquist_*.log<br>
                    <strong>Health Checks:</strong> Every 5 minutes via DGX health monitor
                </div>
            </div>

            <!-- Section: Statistics -->
            <div class="section">
                <h2>üìä Statistiky Projektu</h2>

                <div class="grid">
                    <div class="component-card">
                        <h4>K√≥dov√° B√°ze</h4>
                        <ul style="margin-left: 20px;">
                            <li>151 Python modul≈Ø</li>
                            <li>12 Shell script≈Ø</li>
                            <li>~50,000 ≈ô√°dk≈Ø k√≥du</li>
                            <li>978 MB celkov√° velikost</li>
                        </ul>
                    </div>

                    <div class="component-card">
                        <h4>Data Storage</h4>
                        <ul style="margin-left: 20px;">
                            <li>CDB: 18 MB</li>
                            <li>Qdrant vectors: varies</li>
                            <li>135+ system events</li>
                            <li>Continuous growth</li>
                        </ul>
                    </div>

                    <div class="component-card">
                        <h4>Crawling Coverage</h4>
                        <ul style="margin-left: 20px;">
                            <li>Legal: NSS, √öS, Z√°kony</li>
                            <li>Grants: DotaceEU.cz</li>
                            <li>Tenders: Vƒõstn√≠k VZ</li>
                            <li>News: Multiple sources</li>
                        </ul>
                    </div>

                    <div class="component-card">
                        <h4>Update Frequency</h4>
                        <ul style="margin-left: 20px;">
                            <li>Legal: Dennƒõ</li>
                            <li>Grants: Dennƒõ</li>
                            <li>Tenders: Dennƒõ</li>
                            <li>News: Ka≈ædou hodinu</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>

        <!-- Footer -->
        <footer>
            <p><strong>MAJ-ALMQUIST-LOCAL</strong> - Production System</p>
            <p>Legal RAG & Autonomous Crawling Platform</p>
            <p>Created by Claude + Maj | 2025</p>
            <p style="margin-top: 15px; opacity: 0.8;">
                DGX Workstation 192.168.10.200 | 978MB | 151 Modules
            </p>
        </footer>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#10b981',
                primaryTextColor: '#fff',
                primaryBorderColor: '#059669',
                lineColor: '#059669',
                secondaryColor: '#d1fae5',
                tertiaryColor: '#fef3c7'
            }
        });

        document.querySelectorAll('.nav a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });

        console.log('%c‚öñÔ∏è MAJ-ALMQUIST-LOCAL Documentation', 'color: #10b981; font-size: 20px; font-weight: bold;');
        console.log('%cProduction | 978MB | 151 Modules', 'color: #059669; font-size: 14px;');
    </script>
</body>
</html>
